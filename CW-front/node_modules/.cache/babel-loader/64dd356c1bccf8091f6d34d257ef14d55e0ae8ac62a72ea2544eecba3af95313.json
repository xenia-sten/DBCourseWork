{"ast":null,"code":"import companyService from \"@/services/company.service\";\nimport MyButton from \"./UI/MyButton.vue\";\nimport MyInput from \"./UI/MyInput.vue\";\nimport UserService from \"@/services/user.service\";\nimport jobsServices from \"@/services/jobs.services\";\nimport categoryServices from \"@/services/category.services\";\nimport { format } from \"../../node_modules/@formkit/tempo\";\nexport default {\n  components: {\n    MyButton,\n    MyInput\n  },\n  data() {\n    return {\n      visit: {\n        user_id: \"\",\n        company_id: \"\",\n        template_id: \"\",\n        client_id: \"\",\n        visit_date: \"\",\n        description: \"\"\n      },\n      job_id: \"\",\n      category_id: \"\",\n      companyByUser: [],\n      clientsByCompany: [],\n      jobsByUser: [],\n      categByUser: [],\n      templByCateg: [],\n      currMaster: ''\n    };\n  },\n  methods: {\n    createVisit() {\n      this.visit.visit_date = format({\n        date: this.visit.visit_date,\n        format: \"YYYYDD-MM-YYYY HH:mm:ss\",\n        tz: \"America/Santiago\"\n      });\n      console.log(this.visit.visit_date);\n      this.$emit(\"create\", this.visit);\n      this.visit = {\n        user_id: \"\",\n        company_id: \"\",\n        template_id: \"\",\n        client_id: \"\",\n        visit_date: \"\",\n        description: \"\"\n      };\n    },\n    currClient() {\n      companyService.getClientsByCompany(this.visit.company_id).then(response => {\n        this.clientsByCompany = response.data;\n      }, error => {\n        this.clientsByCompany = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      });\n    },\n    currCategory() {\n      jobsServices.getCategoriesByJob(this.job_id).then(response => {\n        this.categByUser = response.data;\n      }, error => {\n        this.categByUser = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      });\n    },\n    currTemplate() {\n      categoryServices.getTemplByCategory(this.category_id).then(response => {\n        this.templByCateg = response.data;\n      }, error => {\n        this.templByCateg = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n      });\n    }\n  },\n  computed: {\n    currentUser() {\n      return this.$store.state.auth.user;\n    }\n  },\n  watch: {},\n  mounted() {\n    UserService.getCompaniesByUser(this.currentUser.id).then(response => {\n      this.companyByUser = response.data;\n      console.log(this.companyByUser);\n    }, error => {\n      this.companyByUser = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    });\n    UserService.getJobsByUser(this.currentUser.id).then(response => {\n      this.jobsByUser = response.data;\n    }, error => {\n      this.jobsByUser = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    });\n    UserService.getUserById(this.currentUser.id).then(response => {\n      this.visit.user_id = response.data.id;\n      console.log(\"user_id \" + this.visit.user_id);\n    }, error => {\n      this.visit.user_id = error.response && error.response.data && error.response.data.message || error.message || error.toString();\n    });\n  }\n};","map":{"version":3,"names":["companyService","MyButton","MyInput","UserService","jobsServices","categoryServices","format","components","data","visit","user_id","company_id","template_id","client_id","visit_date","description","job_id","category_id","companyByUser","clientsByCompany","jobsByUser","categByUser","templByCateg","currMaster","methods","createVisit","date","tz","console","log","$emit","currClient","getClientsByCompany","then","response","error","message","toString","currCategory","getCategoriesByJob","currTemplate","getTemplByCategory","computed","currentUser","$store","state","auth","user","watch","mounted","getCompaniesByUser","id","getJobsByUser","getUserById"],"sources":["C:\\Users\\Admin\\Desktop\\X\\SSTU\\6 семак\\БД\\DBCourseWork\\CW-front\\src\\components\\VisitForm.vue"],"sourcesContent":["<template>\r\n  <form @submit.prevent>\r\n    <h4>Создание визита</h4>\r\n    <select v-model=\"visit.company_id\">\r\n      <option disabled value=\"\">Выберите компанию</option>\r\n      <option\r\n        v-for=\"company in companyByUser\"\r\n        :key=\"company.id\"\r\n        :value=\"company.id\"\r\n      >\r\n        {{ company.name }}\r\n      </option>\r\n    </select>\r\n    <select v-model=\"visit.client_id\" @click=\"currClient\">\r\n      <option disabled value=\"\">Выберите клиента</option>\r\n      <option\r\n        v-for=\"client in clientsByCompany\"\r\n        :key=\"client.id\"\r\n        :value=\"client.id\"\r\n      >\r\n        {{ client.name }}\r\n      </option>\r\n    </select>\r\n    <select v-model=\"job_id\">\r\n      <option disabled value=\"\">Выберите должность</option>\r\n      <option v-for=\"job in jobsByUser\" :key=\"job.id\" :value=\"job.id\">\r\n        {{ job.name }}\r\n      </option>\r\n    </select>\r\n    <select v-model=\"category_id\" @click=\"currCategory\">\r\n      <option disabled value=\"\">Выберите категорию</option>\r\n      <option\r\n        v-for=\"category in categByUser\"\r\n        :key=\"category.id\"\r\n        :value=\"category.id\"\r\n      >\r\n        {{ category.name }}\r\n      </option>\r\n    </select>\r\n    <select v-model=\"visit.template_id\" @click=\"currTemplate\">\r\n      <option disabled value=\"\">Выберите услугу</option>\r\n      <option\r\n        v-for=\"template in templByCateg\"\r\n        :key=\"template.id\"\r\n        :value=\"template.id\"\r\n      >\r\n        {{ template.name }}\r\n      </option>\r\n    </select>\r\n    <my-input\r\n      v-model=\"visit.visit_date\"\r\n      type=\"text\"\r\n      placeholder=\"Введите дату\"\r\n    />\r\n    <my-input v-model=\"visit.description\" type=\"text\" placeholder=\"Описание\" />\r\n    <my-button\r\n      style=\"align-self: flex-end; margin-top: 15px\"\r\n      @click=\"createVisit\"\r\n    >\r\n      Создать\r\n    </my-button>\r\n  </form>\r\n</template>\r\n\r\n<script>\r\nimport companyService from \"@/services/company.service\";\r\nimport MyButton from \"./UI/MyButton.vue\";\r\nimport MyInput from \"./UI/MyInput.vue\";\r\nimport UserService from \"@/services/user.service\";\r\nimport jobsServices from \"@/services/jobs.services\";\r\nimport categoryServices from \"@/services/category.services\";\r\nimport { format } from \"../../node_modules/@formkit/tempo\";\r\n\r\nexport default {\r\n  components: {\r\n    MyButton,\r\n    MyInput,\r\n  },\r\n  data() {\r\n    return {\r\n      visit: {\r\n        user_id: \"\",\r\n        company_id: \"\",\r\n        template_id: \"\",\r\n        client_id: \"\",\r\n        visit_date: \"\",\r\n        description: \"\",\r\n      },\r\n      job_id: \"\",\r\n      category_id: \"\",\r\n      companyByUser: [],\r\n      clientsByCompany: [],\r\n      jobsByUser: [],\r\n      categByUser: [],\r\n      templByCateg: [],\r\n      currMaster: '',\r\n    };\r\n  },\r\n  methods: {\r\n    createVisit() {\r\n      this.visit.visit_date = format({\r\n        date: this.visit.visit_date,\r\n        format: \"YYYYDD-MM-YYYY HH:mm:ss\",\r\n        tz: \"America/Santiago\",\r\n      });\r\n      console.log(this.visit.visit_date);\r\n      this.$emit(\"create\", this.visit);\r\n      this.visit = {\r\n        user_id: \"\",\r\n        company_id: \"\",\r\n        template_id: \"\",\r\n        client_id: \"\",\r\n        visit_date: \"\",\r\n        description: \"\",\r\n      };\r\n    },\r\n    currClient() {\r\n      companyService.getClientsByCompany(this.visit.company_id).then(\r\n        (response) => {\r\n          this.clientsByCompany = response.data;\r\n        },\r\n        (error) => {\r\n          this.clientsByCompany =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n        }\r\n      );\r\n    },\r\n    currCategory() {\r\n      jobsServices.getCategoriesByJob(this.job_id).then(\r\n        (response) => {\r\n          this.categByUser = response.data;\r\n        },\r\n        (error) => {\r\n          this.categByUser =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n        }\r\n      );\r\n    },\r\n    currTemplate() {\r\n      categoryServices.getTemplByCategory(this.category_id).then(\r\n        (response) => {\r\n          this.templByCateg = response.data;\r\n        },\r\n        (error) => {\r\n          this.templByCateg =\r\n            (error.response &&\r\n              error.response.data &&\r\n              error.response.data.message) ||\r\n            error.message ||\r\n            error.toString();\r\n        }\r\n      );\r\n    },\r\n  },\r\n  computed: {\r\n    currentUser() {\r\n      return this.$store.state.auth.user;\r\n    },\r\n  },\r\n  watch: {\r\n    \r\n  },\r\n  mounted() {\r\n    \r\n    \r\n    UserService.getCompaniesByUser(this.currentUser.id).then(\r\n      (response) => {\r\n        this.companyByUser = response.data;\r\n        console.log(this.companyByUser);\r\n      },\r\n      (error) => {\r\n        this.companyByUser =\r\n          (error.response &&\r\n            error.response.data &&\r\n            error.response.data.message) ||\r\n          error.message ||\r\n          error.toString();\r\n      }\r\n    );\r\n    UserService.getJobsByUser(this.currentUser.id).then(\r\n      (response) => {\r\n        this.jobsByUser = response.data;\r\n      },\r\n      (error) => {\r\n        this.jobsByUser =\r\n          (error.response &&\r\n            error.response.data &&\r\n            error.response.data.message) ||\r\n          error.message ||\r\n          error.toString();\r\n      }\r\n    );\r\n    UserService.getUserById(this.currentUser.id).then(\r\n      (response) => {\r\n        this.visit.user_id = response.data.id;\r\n        console.log(\"user_id \" + this.visit.user_id);\r\n      },\r\n      (error) => {\r\n        this.visit.user_id =\r\n          (error.response &&\r\n            error.response.data &&\r\n            error.response.data.message) ||\r\n          error.message ||\r\n          error.toString();\r\n      }\r\n    );\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nform {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\nselect {\r\n  width: 100%;\r\n  border: 1px solid teal;\r\n  padding: 10px 15px;\r\n  margin-top: 15px;\r\n}\r\n</style>"],"mappings":"AAiEA,OAAOA,cAAa,MAAO,4BAA4B;AACvD,OAAOC,QAAO,MAAO,mBAAmB;AACxC,OAAOC,OAAM,MAAO,kBAAkB;AACtC,OAAOC,WAAU,MAAO,yBAAyB;AACjD,OAAOC,YAAW,MAAO,0BAA0B;AACnD,OAAOC,gBAAe,MAAO,8BAA8B;AAC3D,SAASC,MAAK,QAAS,mCAAmC;AAE1D,eAAe;EACbC,UAAU,EAAE;IACVN,QAAQ;IACRC;EACF,CAAC;EACDM,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,KAAK,EAAE;QACLC,OAAO,EAAE,EAAE;QACXC,UAAU,EAAE,EAAE;QACdC,WAAW,EAAE,EAAE;QACfC,SAAS,EAAE,EAAE;QACbC,UAAU,EAAE,EAAE;QACdC,WAAW,EAAE;MACf,CAAC;MACDC,MAAM,EAAE,EAAE;MACVC,WAAW,EAAE,EAAE;MACfC,aAAa,EAAE,EAAE;MACjBC,gBAAgB,EAAE,EAAE;MACpBC,UAAU,EAAE,EAAE;MACdC,WAAW,EAAE,EAAE;MACfC,YAAY,EAAE,EAAE;MAChBC,UAAU,EAAE;IACd,CAAC;EACH,CAAC;EACDC,OAAO,EAAE;IACPC,WAAWA,CAAA,EAAG;MACZ,IAAI,CAAChB,KAAK,CAACK,UAAS,GAAIR,MAAM,CAAC;QAC7BoB,IAAI,EAAE,IAAI,CAACjB,KAAK,CAACK,UAAU;QAC3BR,MAAM,EAAE,yBAAyB;QACjCqB,EAAE,EAAE;MACN,CAAC,CAAC;MACFC,OAAO,CAACC,GAAG,CAAC,IAAI,CAACpB,KAAK,CAACK,UAAU,CAAC;MAClC,IAAI,CAACgB,KAAK,CAAC,QAAQ,EAAE,IAAI,CAACrB,KAAK,CAAC;MAChC,IAAI,CAACA,KAAI,GAAI;QACXC,OAAO,EAAE,EAAE;QACXC,UAAU,EAAE,EAAE;QACdC,WAAW,EAAE,EAAE;QACfC,SAAS,EAAE,EAAE;QACbC,UAAU,EAAE,EAAE;QACdC,WAAW,EAAE;MACf,CAAC;IACH,CAAC;IACDgB,UAAUA,CAAA,EAAG;MACX/B,cAAc,CAACgC,mBAAmB,CAAC,IAAI,CAACvB,KAAK,CAACE,UAAU,CAAC,CAACsB,IAAI,CAC3DC,QAAQ,IAAK;QACZ,IAAI,CAACf,gBAAe,GAAIe,QAAQ,CAAC1B,IAAI;MACvC,CAAC,EACA2B,KAAK,IAAK;QACT,IAAI,CAAChB,gBAAe,GACjBgB,KAAK,CAACD,QAAO,IACZC,KAAK,CAACD,QAAQ,CAAC1B,IAAG,IAClB2B,KAAK,CAACD,QAAQ,CAAC1B,IAAI,CAAC4B,OAAO,IAC7BD,KAAK,CAACC,OAAM,IACZD,KAAK,CAACE,QAAQ,CAAC,CAAC;MACpB,CACF,CAAC;IACH,CAAC;IACDC,YAAYA,CAAA,EAAG;MACblC,YAAY,CAACmC,kBAAkB,CAAC,IAAI,CAACvB,MAAM,CAAC,CAACiB,IAAI,CAC9CC,QAAQ,IAAK;QACZ,IAAI,CAACb,WAAU,GAAIa,QAAQ,CAAC1B,IAAI;MAClC,CAAC,EACA2B,KAAK,IAAK;QACT,IAAI,CAACd,WAAU,GACZc,KAAK,CAACD,QAAO,IACZC,KAAK,CAACD,QAAQ,CAAC1B,IAAG,IAClB2B,KAAK,CAACD,QAAQ,CAAC1B,IAAI,CAAC4B,OAAO,IAC7BD,KAAK,CAACC,OAAM,IACZD,KAAK,CAACE,QAAQ,CAAC,CAAC;MACpB,CACF,CAAC;IACH,CAAC;IACDG,YAAYA,CAAA,EAAG;MACbnC,gBAAgB,CAACoC,kBAAkB,CAAC,IAAI,CAACxB,WAAW,CAAC,CAACgB,IAAI,CACvDC,QAAQ,IAAK;QACZ,IAAI,CAACZ,YAAW,GAAIY,QAAQ,CAAC1B,IAAI;MACnC,CAAC,EACA2B,KAAK,IAAK;QACT,IAAI,CAACb,YAAW,GACba,KAAK,CAACD,QAAO,IACZC,KAAK,CAACD,QAAQ,CAAC1B,IAAG,IAClB2B,KAAK,CAACD,QAAQ,CAAC1B,IAAI,CAAC4B,OAAO,IAC7BD,KAAK,CAACC,OAAM,IACZD,KAAK,CAACE,QAAQ,CAAC,CAAC;MACpB,CACF,CAAC;IACH;EACF,CAAC;EACDK,QAAQ,EAAE;IACRC,WAAWA,CAAA,EAAG;MACZ,OAAO,IAAI,CAACC,MAAM,CAACC,KAAK,CAACC,IAAI,CAACC,IAAI;IACpC;EACF,CAAC;EACDC,KAAK,EAAE,CAEP,CAAC;EACDC,OAAOA,CAAA,EAAG;IAGR9C,WAAW,CAAC+C,kBAAkB,CAAC,IAAI,CAACP,WAAW,CAACQ,EAAE,CAAC,CAAClB,IAAI,CACrDC,QAAQ,IAAK;MACZ,IAAI,CAAChB,aAAY,GAAIgB,QAAQ,CAAC1B,IAAI;MAClCoB,OAAO,CAACC,GAAG,CAAC,IAAI,CAACX,aAAa,CAAC;IACjC,CAAC,EACAiB,KAAK,IAAK;MACT,IAAI,CAACjB,aAAY,GACdiB,KAAK,CAACD,QAAO,IACZC,KAAK,CAACD,QAAQ,CAAC1B,IAAG,IAClB2B,KAAK,CAACD,QAAQ,CAAC1B,IAAI,CAAC4B,OAAO,IAC7BD,KAAK,CAACC,OAAM,IACZD,KAAK,CAACE,QAAQ,CAAC,CAAC;IACpB,CACF,CAAC;IACDlC,WAAW,CAACiD,aAAa,CAAC,IAAI,CAACT,WAAW,CAACQ,EAAE,CAAC,CAAClB,IAAI,CAChDC,QAAQ,IAAK;MACZ,IAAI,CAACd,UAAS,GAAIc,QAAQ,CAAC1B,IAAI;IACjC,CAAC,EACA2B,KAAK,IAAK;MACT,IAAI,CAACf,UAAS,GACXe,KAAK,CAACD,QAAO,IACZC,KAAK,CAACD,QAAQ,CAAC1B,IAAG,IAClB2B,KAAK,CAACD,QAAQ,CAAC1B,IAAI,CAAC4B,OAAO,IAC7BD,KAAK,CAACC,OAAM,IACZD,KAAK,CAACE,QAAQ,CAAC,CAAC;IACpB,CACF,CAAC;IACDlC,WAAW,CAACkD,WAAW,CAAC,IAAI,CAACV,WAAW,CAACQ,EAAE,CAAC,CAAClB,IAAI,CAC9CC,QAAQ,IAAK;MACZ,IAAI,CAACzB,KAAK,CAACC,OAAM,GAAIwB,QAAQ,CAAC1B,IAAI,CAAC2C,EAAE;MACrCvB,OAAO,CAACC,GAAG,CAAC,UAAS,GAAI,IAAI,CAACpB,KAAK,CAACC,OAAO,CAAC;IAC9C,CAAC,EACAyB,KAAK,IAAK;MACT,IAAI,CAAC1B,KAAK,CAACC,OAAM,GACdyB,KAAK,CAACD,QAAO,IACZC,KAAK,CAACD,QAAQ,CAAC1B,IAAG,IAClB2B,KAAK,CAACD,QAAQ,CAAC1B,IAAI,CAAC4B,OAAO,IAC7BD,KAAK,CAACC,OAAM,IACZD,KAAK,CAACE,QAAQ,CAAC,CAAC;IACpB,CACF,CAAC;EACH;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}